"use strict";(self["webpackChunktest1"]=self["webpackChunktest1"]||[]).push([[595],{3173:function(t,e,a){var o=a(4373);const l=o.A.create({baseURL:"http://localhost:9091"});l.interceptors.request.use((t=>{const e=localStorage.getItem("jwt");return e&&(t.headers.Authorization=`Bearer ${e}`),t}),(t=>Promise.reject(t))),e.A=l},5595:function(t,e,a){a.r(e),a.d(e,{default:function(){return R}});var o=a(6768),l=a(4232);const n={class:"contentW"},s={key:0},c={key:1},d={class:"tbl"},r=["onClick"],i={class:"wd16"},u={class:"wd12"},k={class:"wd10"},h={class:"wd10"},m={key:0},g={class:"wd12"},L={class:"wd10"};function C(t,e,a,C,E,I){const v=(0,o.g2)("Pagination"),_=(0,o.g2)("ChatModal");return(0,o.uX)(),(0,o.CE)("div",n,[e[3]||(e[3]=(0,o.Lk)("ul",null,[(0,o.Lk)("li",{class:"tit"},"ì‹¤ì‹œê°„ ì±„íŒ… ì§€ì›"),(0,o.Lk)("li",{class:"navi"},[(0,o.Lk)("ul",null,[(0,o.Lk)("li",null,"í™ˆ"),(0,o.Lk)("li",null,"ì‹¤ì‹œê°„ ì±„íŒ… ì§€ì›")])])],-1)),0===C.chatrooms.length?((0,o.uX)(),(0,o.CE)("div",s,"ì‹¤ì‹œê°„ ì±„íŒ… ì§€ì›ì´ ì—†ìŠµë‹ˆë‹¤.")):((0,o.uX)(),(0,o.CE)("div",c,[e[2]||(e[2]=(0,o.Lk)("h1",{class:"dpn"},"ì‹¤ì‹œê°„ ì±„íŒ… ì§€ì›",-1)),(0,o.Lk)("table",d,[e[1]||(e[1]=(0,o.Lk)("thead",null,[(0,o.Lk)("tr",null,[(0,o.Lk)("td",{class:"wd6"},"rId"),(0,o.Lk)("td",{class:"wd12"},"ìƒì„±ì¼"),(0,o.Lk)("td",{class:"wd10"},"ë‹µë³€ì"),(0,o.Lk)("td",{class:"wd10"},"ë¬¸ì˜ì"),(0,o.Lk)("td",null,"ì±„íŒ…"),(0,o.Lk)("td",{class:"wd12"},"ë§ˆì§€ë§‰ ì±„íŒ…ì¼"),(0,o.Lk)("td",{class:"wd10"},"ìƒíƒœ(ëŒ€ê¸°/ì§„í–‰ì¤‘/ì™„ë£Œ)")])],-1)),(0,o.Lk)("tbody",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(C.chatrooms?.slice(C.pageStartIdx,C.pageStartIdx+C.ITEM_PER_PAGE),(t=>((0,o.uX)(),(0,o.CE)("tr",{key:t.chatroomId,onClick:e=>C.openChatModal(t.chatroomId)},[(0,o.Lk)("td",i,(0,l.v_)(t.chatroomId),1),(0,o.Lk)("td",u,(0,l.v_)(t.credt),1),(0,o.Lk)("td",k,(0,l.v_)(t.adm?.nick||""),1),(0,o.Lk)("td",h,(0,l.v_)(t.usr?.nick||""),1),(0,o.Lk)("td",null,[(0,o.eW)((0,l.v_)(t.lastContent)+" ",1),null!=C.unreadCounts[t.chatroomId]?((0,o.uX)(),(0,o.CE)("p",m," ( "+(0,l.v_)(C.unreadCounts[t.chatroomId])+" ) ",1)):(0,o.Q3)("",!0)]),(0,o.Lk)("td",g,(0,l.v_)(t.lastCredt),1),(0,o.Lk)("td",L,(0,l.v_)(t.status),1)],8,r)))),128))])]),C.chatrooms.length>0?((0,o.uX)(),(0,o.Wv)(v,(0,o.v6)({key:0,list:C.chatrooms},{ITEM_PER_PAGE:C.ITEM_PER_PAGE,PAGE_PER_SECTION:C.PAGE_PER_SECTION},{onChangePage:C.onChangePage}),null,16,["list","onChangePage"])):(0,o.Q3)("",!0)])),(0,o.bF)(_,{modelValue:C.isModalVisible,"onUpdate:modelValue":e[0]||(e[0]=t=>C.isModalVisible=t),userId:C.userId,nick:C.nick,role:C.role,chatroomId:C.chatroomId},null,8,["modelValue","userId","nick","role","chatroomId"])])}var E=a(144),I=a(3173),v=a(2789),_=a(9383),p=a(5897),P={components:{ChatModal:v.A,Pagination:_.A},setup(){const t=(0,E.KR)(localStorage.getItem("adminId")),e=(0,E.KR)(localStorage.getItem("adminNick")),a=(0,E.KR)("ADM"),l=(0,E.KR)(!1),n=(0,p.L)(),s=(0,o.EW)((()=>n.chatList)),c=(0,o.EW)((()=>n.unreadCounts)),d=(0,E.KR)("");let r=null;const i=(0,E.KR)(5),u=(0,E.KR)(5);let k=(0,E.KR)(1);const h=(0,o.EW)((()=>(k.value-1)*i.value)),m=t=>{k.value=t},g=t=>{d.value=t,l.value=!0,n.markAsRead(t)},L=async()=>{try{const t=await I.A.post("/api/admin/chat/liveChatWaitingList",{});n.setChatList(t.data)}catch(t){console.error("Error fetching chat list:",t)}},C=()=>{let t=`ws://localhost:9090/ws/adminOnList?role=adm&nick=${e.value}`;r=new WebSocket(t),r.onopen=()=>{console.log("activeAdminChkSocket connection opened")},r.onmessage=t=>{console.log("activeAdminChkSocket got message");let e=JSON.parse(t.data);e.forEach((t=>{let e={chatroomId:t._id,id:t.usr.id,nick:t.usr.nick,credt:t.credt,content:t.usr.nick+"ë‹˜ì´ ì…ì¥í•˜ì˜€ìŠµë‹ˆë‹¤."};n.handleIncomingMessage(e)}))},r.onclose=()=>{console.log("activeAdminChkSocket connection closed")},r.onerror=t=>{console.error("activeAdminChkSocket error:",t)}};return(0,o.sV)((()=>{C(),L()})),(0,o.hi)((()=>{r&&r.close()})),(0,o.wB)((()=>n.chatList),(t=>{console.log("ğŸ‘€ chatStore.chatList ë³€ê²½ë¨ (ì‹¤ì‹œê°„):",t)}),{deep:!0}),{userId:t,nick:e,role:a,chatrooms:s,unreadCounts:c,chatroomId:d,isModalVisible:l,openChatModal:g,ITEM_PER_PAGE:i,PAGE_PER_SECTION:u,pageStartIdx:h,onChangePage:m,getLiveChatWaitingList:L}}},w=a(1241);const A=(0,w.A)(P,[["render",C]]);var R=A}}]);
//# sourceMappingURL=595.90e89faa.js.map